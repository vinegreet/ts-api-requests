(this["webpackJsonptest-task-ts-api-requests"]=this["webpackJsonptest-task-ts-api-requests"]||[]).push([[0],[,,,,,,,,,,,,,,,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var c,i=n(1),s=n.n(i),a=n(8),r=n.n(a),o=(n(15),n(7)),l=n.n(o),u=n(9),f=n(2),d={favorites:[],films:[],selectedId:null,initFilms:function(){},selectItem:function(){},setFavorite:function(){},unsetFavorite:function(){}},j=Object(f.a)(Object(f.a)({},d),{},{favorites:null!==(c=function(){try{var e=localStorage.getItem("favorites");if(null===e)return;return JSON.parse(e)}catch(t){return}}())&&void 0!==c?c:d.favorites}),v=Object(i.createContext)(j),b=(n(17),n(0)),p=function(){return Object(b.jsx)("div",{className:"choose-the-film",children:Object(b.jsx)("div",{className:"choose-the-film_title",children:"\u2190 Please choose the film"})})},m=(n(19),function(e){var t=e.film,n=Object(i.useContext)(v),c=n.favorites,s=n.setFavorite,a=n.unsetFavorite,r=t.episode_id,o=t.release_date,l=t.title,u=t.opening_crawl,f=(null!==o&&void 0!==o?o:"").split("-")[0],d=c.includes(r);return Object(b.jsxs)("div",{className:"chosen-film",children:[Object(b.jsx)("div",{className:"chosen-film_header",children:Object(b.jsxs)("h3",{className:"chosen-film_title",children:["Episode ",r,": ",l," (",f,")"]})}),Object(b.jsx)("p",{className:"chosen-film_plot",children:u}),Object(b.jsx)("button",{onClick:function(){d?a(r):s(r)},className:"chosen-film_favorite-button favorite-button ".concat(d?"chosen-film_favorite-button--active":""),children:Object(b.jsx)("span",{className:"favorite-button_inner favorite-button_inner--wrapper",children:Object(b.jsx)("span",{className:"favorite-button_inner favorite-button_inner--inner",children:d?"Favorited ":"Favorite"})})})]})}),O=(n(20),function(){var e=Object(i.useContext)(v),t=e.films,n=e.selectedId,c=e.selectItem,s=t.sort((function(e,t){return e.episode_id-t.episode_id})).map((function(e){var t=e.episode_id,i=e.release_date,s=e.title,a=i.split("-")[0];return Object(b.jsxs)("li",{onClick:function(){c(t)},className:"toc_item ".concat(t===n?"toc_item--active":""),children:["EP",t,": ",s," (",a,")"]},s)}));return Object(b.jsx)("ul",{className:"toc",children:s})}),h=(n(21),function(){var e=Object(i.useContext)(v),t=e.films,n=e.initFilms,c=e.selectedId;if(Object(i.useEffect)((function(){Object(u.a)(l.a.mark((function e(){var t,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("https://swapi.dev").concat("/api/films"));case 3:return t=e.sent,e.next=6,t.json();case 6:c=e.sent,n(null===c||void 0===c?void 0:c.results),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),window.alert(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()}),[]),0===t.length)return Object(b.jsx)("div",{className:"app",children:"Loading..."});var s=t.find((function(e){return e.episode_id===c}));return Object(b.jsxs)("div",{className:"app",children:[Object(b.jsx)("h1",{className:"app_title",children:"Star Wars movies"}),Object(b.jsxs)("div",{className:"app_content",children:[Object(b.jsx)(O,{}),s?Object(b.jsx)(m,{film:s}):Object(b.jsx)(p,{})]})]})}),x=n(5),_=n(10),I=function(e,t){switch(t.type){case"INIT_FILMS":return Object(f.a)(Object(f.a)({},e),{},{films:t.payload});case"SET_FAVORITE":return Object(f.a)(Object(f.a)({},e),{},{favorites:[].concat(Object(x.a)(e.favorites),[t.payload])});case"UNSET_FAVORITE":return Object(f.a)(Object(f.a)({},e),{},{favorites:e.favorites.filter((function(e){return e!==t.payload}))});case"SELECT_ITEM":return Object(f.a)(Object(f.a)({},e),{},{selectedId:t.payload});default:return e}},N=function(e,t,n,c){(function(e){return new Promise((function(t,n){try{var c=JSON.stringify(e);localStorage.setItem("favorites",c),t(null)}catch(i){n()}}))})(t).then((function(){e({type:c,payload:n})})).catch((function(e){console.log(e)}))},E=function(e){var t=e.children,n=Object(i.useReducer)(I,j),c=Object(_.a)(n,2),s=c[0],a=c[1],r=s.favorites,o=s.films,l=s.selectedId,u={favorites:r,films:o,selectedId:l,initFilms:function(e){a({type:"INIT_FILMS",payload:e})},selectItem:function(e){e!==l&&a({type:"SELECT_ITEM",payload:e})},setFavorite:function(e){if(!r.includes(e)){var t=[].concat(Object(x.a)(r),[e]);N(a,t,e,"SET_FAVORITE")}},unsetFavorite:function(e){if(r.includes(e)){var t=r.filter((function(t){return t!==e}));N(a,t,e,"UNSET_FAVORITE")}}};return Object(b.jsx)(v.Provider,{value:u,children:t})};r.a.render(Object(b.jsx)(s.a.StrictMode,{children:Object(b.jsx)(E,{children:Object(b.jsx)(h,{})})}),document.getElementById("root"))}],[[22,1,2]]]);
//# sourceMappingURL=main.f90c9774.chunk.js.map